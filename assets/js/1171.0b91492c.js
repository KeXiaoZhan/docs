(window.webpackJsonp=window.webpackJsonp||[]).push([[1171],{1575:function(v,_,t){"use strict";t.r(_);var e=t(58),a=Object(e.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"计算机网络"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#计算机网络"}},[v._v("#")]),v._v(" 计算机网络")]),v._v(" "),t("h2",{attrs:{id:"传输层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#传输层"}},[v._v("#")]),v._v(" 传输层")]),v._v(" "),t("h3",{attrs:{id:"udp协议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#udp协议"}},[v._v("#")]),v._v(" UDP协议")]),v._v(" "),t("p",[v._v("特点：")]),v._v(" "),t("ul",[t("li",[v._v("无连接")]),v._v(" "),t("li",[v._v("尽最大努力交付")]),v._v(" "),t("li",[v._v("面向报文")])]),v._v(" "),t("p",[v._v("UDP适合数据量少的,UDP没有拥塞控制,适合很多实时应用,允许丢包")]),v._v(" "),t("p",[v._v("UDP首部较小，只有8字节，而TCP由20字节。这也是"),t("code",[v._v("减少网络传输开销")]),v._v("的一方面。")]),v._v(" "),t("h3",{attrs:{id:"tcp协议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp协议"}},[v._v("#")]),v._v(" TCP协议")]),v._v(" "),t("p",[v._v("TCP协议简单来说是一种位于传输层的，面向连接的、可靠的、基于字节流的传输层通信协议")]),v._v(" "),t("p",[v._v("特点：")]),v._v(" "),t("ul",[t("li",[v._v("面向连接")]),v._v(" "),t("li",[v._v("点对点通信")]),v._v(" "),t("li",[v._v("提供可靠的交付")]),v._v(" "),t("li",[v._v("全双工通信")]),v._v(" "),t("li",[v._v("面向字节流")])]),v._v(" "),t("h4",{attrs:{id:"tcp报文的首部格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp报文的首部格式"}},[v._v("#")]),v._v(" TCP报文的首部格式")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/KeXiaoZhan/Images/334dcc7b195c40bf90fa747705deb9cc~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"img"}})]),v._v(" "),t("ul",[t("li",[v._v("6个控制位介绍如下")])]),v._v(" "),t("table",[t("thead",[t("tr",[t("th",[v._v("控制位")]),v._v(" "),t("th",[v._v("作用")])])]),v._v(" "),t("tbody",[t("tr",[t("td",[v._v("ACK")]),v._v(" "),t("td",[v._v("置1时表示确认号合法，为0的时候表示数据段不包含确认信息，确认号被忽略")])]),v._v(" "),t("tr",[t("td",[v._v("PSH")]),v._v(" "),t("td",[v._v("置1时请求的数据段在接收方得到后就可直接送到应用程序，而不必等到缓冲区满时才传送")])]),v._v(" "),t("tr",[t("td",[v._v("RST")]),v._v(" "),t("td",[v._v("置1时重建连接。如果接收到RST位时候，通常发生了某些错")])]),v._v(" "),t("tr",[t("td",[v._v("SYN")]),v._v(" "),t("td",[v._v("置1时用来发起一个连接")])]),v._v(" "),t("tr",[t("td",[v._v("FIN")]),v._v(" "),t("td",[v._v("置1时表示发端完成发送任务。用来释放连接，表明发送方已经没有数据发送了")])]),v._v(" "),t("tr",[t("td",[v._v("URG")]),v._v(" "),t("td",[v._v("紧急指针，告诉接收TCP模块紧要指针域指着紧要数据")])])])]),v._v(" "),t("h4",{attrs:{id:"tcp建立连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp建立连接"}},[v._v("#")]),v._v(" TCP建立连接")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/KeXiaoZhan/Images/fc6bd0c4f0264ffcb426c5632903ed9d~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"img"}})]),v._v(" "),t("p",[v._v("客户端： 我要连接（不能携带数据）")]),v._v(" "),t("p",[v._v("服务端: \t我也要连接，你的连接我确认了")]),v._v(" "),t("p",[v._v("客户端:     你的连接我也确认了（可以携带数据）")]),v._v(" "),t("h4",{attrs:{id:"tcp释放连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp释放连接"}},[v._v("#")]),v._v(" TCP释放连接")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ad9322a88a5c4b529b553b4f5d5efbe7~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"img"}})]),v._v(" "),t("p",[v._v("客户端: \t我不连了")]),v._v(" "),t("p",[v._v("服务端：   嗯，我知道了，我允许你断开，但是我等我现在发的东西发完，现在还不能断开  （此过程为ACK发送）")]),v._v(" "),t("p",[v._v("服务端：  东西我发完了，咱们断了吧   （此过程为FIN发送）")]),v._v(" "),t("p",[v._v("客户端：  我知晓了，再见")]),v._v(" "),t("h4",{attrs:{id:"_3次握手4次挥手"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3次握手4次挥手"}},[v._v("#")]),v._v(" 3次握手4次挥手")]),v._v(" "),t("blockquote",[t("p",[v._v("为什么连接的时候是三次握手，关闭的时候却是四次握手？")])]),v._v(" "),t("ul",[t("li",[v._v("关闭连接时，服务器收到对方的"),t("code",[v._v("FIN")]),v._v("报文时，仅仅表示对方不再发送数据了但是还能接收数据，而自己也未必全部数据都发送给对方了，所以己方可以立即关闭，也可以发送一些数据给对方后，再发送"),t("code",[v._v("FIN")]),v._v("报文给对方来表示同意现在关闭连接")]),v._v(" "),t("li",[v._v("因此，己方"),t("code",[v._v("ACK和FIN")]),v._v("一般都会分开发送，从而导致多了一次")])]),v._v(" "),t("blockquote",[t("p",[v._v("为什么不能用两次握手进行连接？")])]),v._v(" "),t("p",[v._v("以下是网上普遍的解答：")]),v._v(" "),t("ul",[t("li",[v._v("若建立连接只需两次握手，客户端并没有太大的变化，仍然需要获得服务端的应答后才进入"),t("code",[v._v("ESTABLISHED")]),v._v("状态（"),t("font",{attrs:{color:"red",size:"3"}},[v._v("连接成功状态")]),v._v("），而服务端在收到连接请求后就进入"),t("code",[v._v("ESTABLISHED")]),v._v("状态。")],1),v._v(" "),t("li",[v._v("此时"),t("font",{attrs:{color:"red",size:"3"}},[v._v("如果网络拥塞")]),v._v("，客户端发送的"),t("font",{attrs:{color:"red",size:"3"}},[v._v("连接请求迟迟到不了服务端")]),v._v("，客户端便超时"),t("font",{attrs:{color:"red",size:"3"}},[v._v("重发请求")]),v._v("，如果服务端正确接收并确认应答，双方便开始通信，通信结束后释放连接。此时，"),t("font",{attrs:{color:"red",size:"3"}},[v._v("如果那个失效的连接请求抵达了服务端")]),v._v("，由于只有两次握手，服务端收到请求就会进入"),t("code",[v._v("ESTABLISHED")]),v._v("状态，等待发送数据或主动发送数据")],1),v._v(" "),t("li",[v._v("但"),t("font",{attrs:{color:"red",size:"3"}},[v._v("此时的客户端")]),v._v("早已进入"),t("code",[v._v("CLOSED")]),v._v("状态，服务端将会一直等待下去，这样浪费服务端连接资源")],1),v._v(" "),t("li",[v._v("但我觉得这个只是两次握手可能造成的问题，最关键的是两次握手有服务器对客户端的起始序列号做了确认，"),t("code",[v._v("但客户端却没有对服务器的起始序列号做确认")]),v._v("，不能保证传输的可靠性。")])]),v._v(" "),t("blockquote",[t("p",[v._v("如果已经建立了连接，但是客户端突然出现故障了怎么办？")])]),v._v(" "),t("p",[v._v("TCP保活计时器 每次客户端请求服务器会重置计时器，当"),t("code",[v._v("2小时之内")]),v._v("没收到客户端任何数据时，会"),t("code",[v._v("每隔75s")]),v._v("向客户端发一个探测报文，若接连发送"),t("code",[v._v("10个")]),v._v("，客户端都没有反应，则认为客户端故障，关闭连接。")]),v._v(" "),t("blockquote",[t("p",[v._v("什么是SYN洪泛攻击？")])]),v._v(" "),t("ul",[t("li",[v._v("SYN洪泛攻击就是利用TCP协议的特性（三次握手）。")]),v._v(" "),t("li",[v._v("攻击者发送"),t("code",[v._v("TCP的 SYN")]),v._v("，SYN是TCP三次握手中第一个数据包，而当服务器返回ACK后，该攻击者就不对其进行再确认，那这个TCP连接就处于挂起状态，也就是半连接状态，服务器收不到再确认的话，还会重复发送ACK给攻击者。")]),v._v(" "),t("li",[v._v("这样更加会浪费服务器资源。攻击者就对服务器发送大量的这种TCP连接，由于每一个连接都无法完成三次握手，所以就在服务器上，这些TCP连接会因为挂起状态而消耗CPU和内存，最后服务器可能死机。")])]),v._v(" "),t("blockquote",[t("p",[v._v("序号（ISN）为什么要随机？")])]),v._v(" "),t("p",[v._v("增加安全性，为了避免被第三方猜测到，从而被第三方伪造的RST报文Reset。")]),v._v(" "),t("blockquote",[t("p",[v._v("三次握手的第一次可以携带数据吗？为何？")])]),v._v(" "),t("ul",[t("li",[v._v("不可以，三次握手还没有完成。而且这样会放大"),t("code",[v._v("SYN FLOOD")]),v._v("（SYN洪泛）攻击。")]),v._v(" "),t("li",[v._v("如果攻击者伪造了成千上万的握手报文，携带了1K+ 字节的数据，而接收方会开辟大量的缓存来容纳这些巨大数据，内存会很容易耗尽，从而拒绝服务。")])]),v._v(" "),t("h4",{attrs:{id:"tcp如何实现可靠传输"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp如何实现可靠传输"}},[v._v("#")]),v._v(" TCP如何实现可靠传输")]),v._v(" "),t("p",[v._v("主要通过以下四种方式实现可靠传输机制：")]),v._v(" "),t("ul",[t("li",[v._v("校验")]),v._v(" "),t("li",[v._v("序号")]),v._v(" "),t("li",[v._v("确认")]),v._v(" "),t("li",[v._v("重传")])]),v._v(" "),t("h4",{attrs:{id:"tcp的流量控制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp的流量控制"}},[v._v("#")]),v._v(" TCP的流量控制")]),v._v(" "),t("p",[v._v("为什么需要流量控制呢？")]),v._v(" "),t("p",[v._v("比如发送方发送速度非常快，接收方接收速度特别慢，这样就会发生严重的丢包现象。")]),v._v(" "),t("p",[v._v("(建议网上找一个动画教程来理解，文字效果不是很好):")]),v._v(" "),t("p",[t("font",{attrs:{color:"red",size:"3"}},[v._v("TCP 中采用滑动窗口来进行传输控制")]),v._v("，"),t("code",[v._v("滑动窗口的大小意味着接收方还有多大的缓冲区可以用于接收数据")]),v._v("。发送方可以通过滑动窗口的大小来确定应该发送多少字节的数据。")],1),v._v(" "),t("p",[v._v("当滑动窗口为 "),t("code",[v._v("0")]),v._v("时，发送方一般"),t("code",[v._v("不能再发送数据报")]),v._v("，但有两种情况除外，一种情况是可以发送紧急数据，例如，允许用户终止在远端机上的运行进程。另一种情况是发送方可以发送一个 1 字节的数据报来通知接收方重新声明它希望接收的下一字节及发送方的滑动窗口大小。")]),v._v(" "),t("h4",{attrs:{id:"tcp的拥塞控制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp的拥塞控制"}},[v._v("#")]),v._v(" TCP的拥塞控制")]),v._v(" "),t("p",[v._v("这部分我也觉得文字部分太生硬了，开始我也不怎么理解，看来一个视频之后我了解了基本原理，这里我文字版和视频地址都放上来。")]),v._v(" "),t("p",[v._v("视频地址如下："),t("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2Fav83688722%3Ffrom%3Dsearch%26seid%3D15487015846130335760",target:"_blank",rel:"noopener noreferrer"}},[v._v("拥塞控制视频版"),t("OutboundLink")],1)]),v._v(" "),t("h2",{attrs:{id:"应用层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#应用层"}},[v._v("#")]),v._v(" 应用层")]),v._v(" "),t("p",[v._v("应用层对应用程序的通信提供服务。")]),v._v(" "),t("ul",[t("li",[v._v("区分是发送报文还是接收报文")]),v._v(" "),t("li",[v._v("定义报文类型的语法，比如某字段的意思，例如http中content-type字段是什么意思。")]),v._v(" "),t("li",[v._v("最后就是进程如何，什么时候把传输层的数据交给应用层。")])]),v._v(" "),t("p",[v._v("一些比较重要的应用层协议如下图：")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/204170d27f044a38a13d590891fe749d~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"img"}})]),v._v(" "),t("h3",{attrs:{id:"常见模型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常见模型"}},[v._v("#")]),v._v(" 常见模型")]),v._v(" "),t("p",[v._v("第一种是客户端/服务器模型，也就是C/S架构。比如电子邮件、web都是。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/KeXiaoZhan/Images/f82f6138a9eb47018c20ecee445f1ea0~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"img"}})]),v._v(" "),t("p",[v._v("第二种是P2P模型，每个主机既可以提供服务，也可以请求服务。比如迅雷下载也是使用P2P技术的。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c11fe0e6bd5e46ef8971e2a4a0ebc39b~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"img"}})]),v._v(" "),t("h3",{attrs:{id:"链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#链接"}},[v._v("#")]),v._v(" 链接")]),v._v(" "),t("p",[v._v("短连接")]),v._v(" "),t("p",[v._v("当客户端有请求时，会建立一个TCP连接，接收到服务器响应后，就断开连接。下次有请求时，再建立连接，收到响应后，再断开。如此循环。这种方式主要有两个缺点：")]),v._v(" "),t("p",[v._v("建立TCP连接需要3次“握手”，拆除TCP连接需要4次“挥手”，这就需要7个数据包。如果请求和响应各占1个数据包，那么一次短连接的交互过程，有效的传输仅占2/9，这个利用率太低了。")]),v._v(" "),t("p",[v._v("主动断开TCP连接的一端，TCP状态机会进入TIME_WAIT状态。如果频繁地使用短连接方式，就有可能使客户端的机器产生大量的处于TIME_WAIT状态TCP连接。")]),v._v(" "),t("p",[v._v("长链接")]),v._v(" "),t("p",[v._v("客户端和服务器建立TCP连接后，会一直使用这条连接进行数据交互，直到没有数据传输或异常断开。在空闲期间，通常会使用``心跳数据包（Keep-Alive）`保持链路不断开。目前长连接方式应用范围比较广泛。")]),v._v(" "),t("h3",{attrs:{id:"dns"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dns"}},[v._v("#")]),v._v(" DNS")]),v._v(" "),t("p",[v._v("什么是DNS说白了就是将域名转化为ip，比如www.qq.com，这是域名，可以是网络包需要对方ip地址，域名是不能加入网络包报头的，所以就需要去找一个服务器问，qq的域名对应的ip是多少。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/445331c021914140884f047bba7d1e1e~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"img"}})]),v._v(" "),t("h3",{attrs:{id:"http报文头分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#http报文头分析"}},[v._v("#")]),v._v(" HTTP报文头分析")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6581ae39a024430c8649ac34c640166e~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp",alt:"img"}})]),v._v(" "),t("p",[v._v("下面是对各部分的简要描述：")]),v._v(" "),t("ol",[t("li",[v._v("方法(method)：客户端希望服务器对资源执行的动作，是一个单独的词，比如，"),t("code",[v._v("GET、POST或HEAD")])]),v._v(" "),t("li",[v._v("请求URL(request-URL)：要直接与服务器进行对话，只要请求URL是资源的"),t("code",[v._v("绝对路径")]),v._v("就可以了，服务器可以假定自己是URL的主机/端口")]),v._v(" "),t("li",[v._v("版本(version)：报文所使用的"),t("code",[v._v("HTTP版本")]),v._v("。其格式：HTTP/<主要版本号>.<次要版本号>")]),v._v(" "),t("li",[v._v("状态码(status-code)：状态码是三位数字，描述了"),t("code",[v._v("请求过程中所发生的情况")]),v._v("。每个状态码的第一位数字都用于描述状态的一般类别(比如，“成功”、“出错”等等)")]),v._v(" "),t("li",[v._v("原因短语(reason-phrase)：数字状态码的可读版本，包含行终止序列之前的所有文本。原因短语只对人类有意义，因此，尽管响应行"),t("code",[v._v("HTTP/1.0 200 NOT OK")]),v._v("和"),t("code",[v._v("HTTP/1.0 200 OK")]),v._v("中原因短语的含义不同，但同样都会被当作成功指示处理")]),v._v(" "),t("li",[v._v("头部(header)：可以有零个或多个头部，每个首部都包含一个名字，后面跟着一个冒号(😃，然后是一个可选的空格，接着是一个值，最后是一个CRLF首部是由一个空行(CRLF)结束的，表示了头部列表的结束和实体主体部分的开始")]),v._v(" "),t("li",[v._v("实体的主体部分(entity-body)：实体的主体部分包含一个由任意数据组成的数据块，并不是所有的报文都包含实体的主体部分，有时，报文只是以一个CRLF结束。")])]),v._v(" "),t("p",[v._v("下面是常用头部：")]),v._v(" "),t("blockquote",[t("p",[v._v("通用头部：既可以出现在请求报文中，也可以出现在响应报文中，它提供了与报文相关的最基本的信息")])]),v._v(" "),t("ul",[t("li",[v._v("Connection：允许客户端和服务器指定与请求/响应连接有关的选项，"),t("code",[v._v("http1.1默认是keep-alive")])]),v._v(" "),t("li",[v._v("Date：提供日期和时间标志，说明报文是什么时间创建的")]),v._v(" "),t("li",[v._v("Transfer-Encoding：告知接收端为了保证报文的可靠传输，对报文采用了什么编码方式")]),v._v(" "),t("li",[v._v("Cache-Control：用于随报文传送缓存指示")])]),v._v(" "),t("blockquote",[t("p",[v._v("请求头部：请求头部是只在请求报文中有意义的头部。用于说明是谁或什么在发送请求、请求源自何处，或者客户端的喜好及能力")])]),v._v(" "),t("ul",[t("li",[v._v("Host：给出了接收请求的服务器的主机名和端口号")]),v._v(" "),t("li",[v._v("Referer：提供了包含当前请求URI的文档的URL")]),v._v(" "),t("li",[v._v("User-Agent：将发起请求的应用程序名称告知服务器")]),v._v(" "),t("li",[v._v("Accept：告诉服务器能够发送哪些媒体类型")]),v._v(" "),t("li",[v._v("Accept-Encoding：告诉服务器能够发送哪些编码方式")]),v._v(" "),t("li",[v._v("Accept-Language：告诉服务器能够发送哪些语言")]),v._v(" "),t("li",[v._v("Range：如果服务器支持范围请求，就请求资源的指定范围")]),v._v(" "),t("li",[v._v("If-Range：允许对文档的某个范围进行条件请求")]),v._v(" "),t("li",[v._v("Authorization：包含了客户端提供给服务器，以便对其自身进行认证的数据")]),v._v(" "),t("li",[v._v("Cookie：客户端用它向服务器传送数据")])]),v._v(" "),t("blockquote",[t("p",[v._v("响应头部：响应头部为客户端提供了一些额外信息，比如谁在发送响应、响应者的功能，甚至与响应相关的一些特殊指令")])]),v._v(" "),t("ul",[t("li",[v._v("Age：(从最初创建开始)响应持续时间")]),v._v(" "),t("li",[v._v("Server：服务器应用程序软件的名称和版本")]),v._v(" "),t("li",[v._v("Accept-Ranges：对此资源来说，服务器可接受的范围类型")]),v._v(" "),t("li",[v._v("Set-Cookie：在客户端设置数据，以便服务器对客户端进行标识")])]),v._v(" "),t("blockquote",[t("p",[v._v("实体首部：描述主体的长度和内容，或者资源自身")])]),v._v(" "),t("ul",[t("li",[v._v("Allow：列出了可以对此实体执行的请求方法")]),v._v(" "),t("li",[v._v("Location：告知客户端实体实际上位于何处，用于将接收端定向到资源的位置(URL)上去")]),v._v(" "),t("li",[v._v("Content-Base：解析主体中的相对URL时使用的基础URL")]),v._v(" "),t("li",[v._v("Content-Encoding：对主体执行的任意编码方式")]),v._v(" "),t("li",[v._v("Content-Language：理解主体时最适宜使用的自然语言")]),v._v(" "),t("li",[v._v("Content-Length：主体的长度")]),v._v(" "),t("li",[v._v("Content-Type：这个主体的对象类型")]),v._v(" "),t("li",[v._v("ETag：与此实体相关的实体标记")]),v._v(" "),t("li",[v._v("Last-Modified：这个实体最后一次被修改的日期和时间")])]),v._v(" "),t("blockquote",[t("p",[v._v("实体的主体部分：该部分其实就是HTTP要传输的内容，是可选的。HTTP报文可以承载很多类型的数字数据，比如，图片、视频、HTML文档电子邮件、软件应用程序等等。")])])])}),[],!1,null,null,null);_.default=a.exports}}]);